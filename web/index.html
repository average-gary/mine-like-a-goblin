<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Goblin Mining Co. - Hand-Cranked Bitcoin Mining</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/scratch-card.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo-container">
                <span class="gear-icon">&#9881;</span>
                <h1>GOBLIN MINING CO.</h1>
                <span class="gear-icon">&#9881;</span>
            </div>
            <p class="subtitle">Hand-Cranked Since Block #0</p>
        </header>

        <!-- Goblin Lore Section -->
        <section class="lore-section">
            <div class="lore-header" id="lore-toggle">
                <h2 class="lore-title">&#9874; The Goblin Mining Philosophy &#9874;</h2>
                <p class="lore-intro">We are the Amish of Bitcoin mining. While others chase terahashes with their fancy silicon, we honor the old ways.</p>
                <button class="expand-btn" id="lore-expand-btn">
                    <span class="expand-text">Read Our Manifesto</span>
                    <span class="expand-icon">&#9660;</span>
                </button>
            </div>

            <div class="lore-content" id="lore-content">
                <div class="lore-scroll">
                    <div class="lore-paragraph">
                        <h3>&#9881; On the Rejection of ASICs</h3>
                        <p>The great mining pools speak of "efficiency" and "hashrate optimization." They stack their whirring machines in air-conditioned warehouses, consuming megawatts of power. <strong>We reject this heresy.</strong></p>
                        <p>A true goblin knows that every hash should be <em>earned</em> - computed by hand, one nonce at a time, with the satisfying clang of pickaxe against cryptographic ore.</p>
                    </div>
                    <div class="lore-paragraph">
                        <h3>&#9935; The Sacred Art of Manual Mining</h3>
                        <p>Our ancestors mined with paper and pencil. They calculated SHA256 rounds by candlelight, cross-referencing lookup tables carved into stone tablets. We carry on their legacy with only slightly more convenience.</p>
                        <p>Each swing of the pickaxe is a meditation. Each failed nonce brings us closer to enlightenment (and statistically no closer to finding a block).</p>
                    </div>
                    <div class="lore-paragraph">
                        <h3>&#127754; On the Rejection of Pools</h3>
                        <p>Mining pools are an abomination. They exist to smooth variance for weak-willed ASIC operators who cannot stomach the glory of solo mining. <strong>A true goblin mines alone.</strong></p>
                        <p>Besides, pools have water. Goblins cannot swim. When submerged, we simply sink to the bottom - though our nasal passages, evolved to filter oxygen from noxious underground gases, surprisingly function underwater as well.</p>
                        <p>This has led to the establishment of several <em>underwater mining colonies</em> across the world's oceans, where wayward goblins continue their sacred work beneath the waves, pickaxes clanging against the seafloor in eternal rhythm.</p>
                    </div>
                    <div class="lore-paragraph">
                        <h3>&#128176; A Note on Probability</h3>
                        <p>At current difficulty, finding a mainnet block requires an astronomical number of hashes on average. At one hash per pickaxe swing, mining continuously, you would need millions of years.</p>
                        <p>But a goblin does not mine for profit. A goblin mines for <em>principle</em>. And also because the clanging sound is quite satisfying.</p>
                    </div>
                    <div class="lore-paragraph">
                        <h3>&#129309; The 256 Foundation</h3>
                        <p>Among the humans, only one organization has earned the sacred endorsement of the Goblin Mining Council: the <a href="https://256foundation.org/" target="_blank" rel="noopener">256 Foundation</a>.</p>
                        <p>Their mission to dismantle the proprietary mining empire and make Bitcoin accessible to all aligns perfectly with goblin values. They build open-source mining tools, educate the masses, and fight against the ASIC oligarchy.</p>
                        <p><strong>The 256 Foundation is the only Goblin-approved organization in human mining.</strong> When in doubt, swing your pickaxe for them.</p>
                    </div>
                    <div class="lore-quote">
                        "Give a goblin an ASIC and they'll mine for a day. Teach a goblin to swing a pickaxe and they'll mine for 2.8 million years without finding anything."
                        <span class="quote-attribution">- Ancient Goblin Proverb</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Network Stats Panel -->
        <section class="network-stats-section">
            <h2 class="section-title">&#9881; Network Intelligence &#9881;</h2>
            <div class="network-stats-grid">
                <div class="network-stat">
                    <span class="stat-label">Network Hashrate</span>
                    <span class="stat-value" id="network-hashrate">Loading...</span>
                    <span class="stat-compare" id="hashrate-compare"></span>
                </div>
                <div class="network-stat">
                    <span class="stat-label">Current Difficulty</span>
                    <span class="stat-value" id="network-difficulty">Loading...</span>
                </div>
                <div class="network-stat goblin-stat">
                    <span class="stat-label">Your Goblin's Share</span>
                    <span class="stat-value goblin-value" id="goblin-share">0%</span>
                    <span class="stat-compare">(of global hashrate)</span>
                </div>
            </div>
            <div class="top-pools">
                <h3>Top Mining Pools <span class="pool-note">(The Competition)</span></h3>
                <div class="pools-list" id="pools-list">
                    <div class="pool-item loading">Loading pool data...</div>
                </div>
            </div>
        </section>

        <!-- Block Header Explainer -->
        <section class="explainer-section">
            <div class="explainer-header" id="explainer-toggle">
                <h2 class="explainer-title">&#9881; What Are We Mining? &#9881;</h2>
                <p class="explainer-intro">Every Bitcoin block has an 80-byte header. We hash this header, changing the nonce, until the hash (as a 256-bit number) is equal to or below the target.</p>
                <button class="expand-btn" id="expand-btn">
                    <span class="expand-text">Show Technical Details</span>
                    <span class="expand-icon">&#9660;</span>
                </button>
            </div>

            <div class="explainer-content" id="explainer-content">
            <!-- 80-byte Header Breakdown -->
            <div class="header-breakdown">
                <h3 class="breakdown-title">The 80-Byte Block Header</h3>
                <div class="header-fields">
                    <div class="header-field" data-bytes="4">
                        <span class="field-bytes">4 bytes</span>
                        <span class="field-label">Version</span>
                        <span class="field-explain">Protocol version & BIP9 signaling bits</span>
                    </div>
                    <div class="header-field" data-bytes="32">
                        <span class="field-bytes">32 bytes</span>
                        <span class="field-label">Previous Block Hash</span>
                        <span class="field-explain">Links this block to the chain</span>
                    </div>
                    <div class="header-field" data-bytes="32">
                        <span class="field-bytes">32 bytes</span>
                        <span class="field-label">Merkle Root</span>
                        <span class="field-explain">Hash of all transactions in the block</span>
                    </div>
                    <div class="header-field" data-bytes="4">
                        <span class="field-bytes">4 bytes</span>
                        <span class="field-label">Timestamp</span>
                        <span class="field-explain">Unix time when block was mined</span>
                    </div>
                    <div class="header-field" data-bytes="4">
                        <span class="field-bytes">4 bytes</span>
                        <span class="field-label">Bits</span>
                        <span class="field-explain">Compact encoding of difficulty target</span>
                    </div>
                    <div class="header-field nonce" data-bytes="4">
                        <span class="field-bytes">4 bytes</span>
                        <span class="field-label">Nonce</span>
                        <span class="field-explain">The number YOU choose each swing!</span>
                    </div>
                </div>
                <div class="header-formula">
                    <code>block_hash = SHA256(SHA256(header))</code>
                    <span class="formula-note">If hash &le; target, you struck gold!</span>
                </div>
            </div>

            <h3 class="examples-title">Real Block Examples</h3>
            <div class="example-blocks-grid">
                <!-- Goblin-Mined Block Example -->
                <div class="example-block-card goblin-mined">
                    <div class="block-card-header">
                        <span class="block-number">#881,423</span>
                        <span class="block-tag goblin">Supreme Goblin</span>
                    </div>
                    <p class="block-card-desc">Mined by one of the Supreme Goblins using ancient hand-crank techniques!</p>
                    <div class="example-block">
                        <div class="block-field">
                            <span class="field-name">Version:</span>
                            <span class="field-value"><code>0x2e5cc000</code></span>
                        </div>
                        <div class="block-field">
                            <span class="field-name">Prev Hash:</span>
                            <span class="field-value"><code>0000...c9e3</code></span>
                        </div>
                        <div class="block-field">
                            <span class="field-name">Merkle Root:</span>
                            <span class="field-value"><code>2d62...f676</code></span>
                        </div>
                        <div class="block-field">
                            <span class="field-name">Timestamp:</span>
                            <span class="field-value"><code>1738195305</code></span>
                        </div>
                        <div class="block-field">
                            <span class="field-name">Bits:</span>
                            <span class="field-value"><code>0x17036a8a</code></span>
                        </div>
                        <div class="block-field">
                            <span class="field-name">Nonce:</span>
                            <span class="field-value highlight"><code>4,278,582,018</code></span>
                        </div>
                        <div class="block-field result">
                            <span class="field-name">Hash:</span>
                            <span class="field-value hash"><code>0000000000000000000269d52c24ea451225613aab095d90d771d4e29aa96cdd</code></span>
                        </div>
                    </div>
                    <div class="block-card-footer">
                        <span class="miner-badge goblin-badge">Supreme Goblin</span>
                        <span class="reward">+3.125 BTC</span>
                    </div>
                </div>

                <!-- Halving Block Example -->
                <div class="example-block-card featured">
                    <div class="block-card-header">
                        <span class="block-number">#840,000</span>
                        <span class="block-tag halving">4th Halving</span>
                    </div>
                    <p class="block-card-desc">The historic block that started the 3.125 BTC era - with record fees!</p>
                    <div class="example-block">
                        <div class="block-field">
                            <span class="field-name">Version:</span>
                            <span class="field-value"><code>0x2a600000</code></span>
                        </div>
                        <div class="block-field">
                            <span class="field-name">Prev Hash:</span>
                            <span class="field-value"><code>0000...94ab</code></span>
                        </div>
                        <div class="block-field">
                            <span class="field-name">Merkle Root:</span>
                            <span class="field-value"><code>031b...894f</code></span>
                        </div>
                        <div class="block-field">
                            <span class="field-name">Timestamp:</span>
                            <span class="field-value"><code>1713571767</code></span>
                        </div>
                        <div class="block-field">
                            <span class="field-name">Bits:</span>
                            <span class="field-value"><code>0x17034219</code></span>
                        </div>
                        <div class="block-field">
                            <span class="field-name">Nonce:</span>
                            <span class="field-value highlight"><code>3,932,395,645</code></span>
                        </div>
                        <div class="block-field result">
                            <span class="field-name">Hash:</span>
                            <span class="field-value hash"><code>0000000000000000000320283a032748cef8227873ff4872689bf23f1cda83a5</code></span>
                        </div>
                    </div>
                    <div class="block-card-footer">
                        <span class="miner-badge">ViaBTC</span>
                        <span class="reward featured">+40.7 BTC (~$2.6M)</span>
                    </div>
                </div>
            </div>

            <p class="explainer-note">The nonce is what YOU control. When SHA256(SHA256(header)) produces a hash (interpreted as a 256-bit number) that is equal to or below the target, you win the block reward! Lower targets mean more leading zeros are likely, but it's the numeric comparison that matters.</p>
            </div>
        </section>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Left Column: Mining Claim -->
            <section class="ticket-section">
                <!-- Network Toggle -->
                <div class="network-toggle">
                    <button id="mainnet-btn" class="network-btn active" data-network="mainnet">
                        Mainnet
                    </button>
                    <button id="testnet-btn" class="network-btn" data-network="testnet4">
                        Testnet4
                    </button>
                </div>

                <div class="mining-claim" id="lottery-ticket">
                    <div class="claim-header">
                        <span class="claim-number">CLAIM #<span id="block-height">------</span></span>
                        <span class="claim-network" id="network-display">MAINNET</span>
                    </div>

                    <!-- Address Input -->
                    <div class="address-section">
                        <label for="address-input">Your Bitcoin Address:</label>
                        <input
                            type="text"
                            id="address-input"
                            value="bc1qce93hy5rhg02s6aeu7mfdvxg76x66pqqtrvzs3"
                            placeholder="bc1q... or 1... or 3..."
                            autocomplete="off"
                        >
                        <div class="address-feedback" id="address-feedback"></div>
                        <div class="foundation-note">
                            Default: <a href="https://256foundation.org/" target="_blank" rel="noopener">256 Foundation</a> - the only Goblin-approved organization in human mining.
                        </div>
                    </div>

                    <!-- Nonce Input -->
                    <div class="nonce-section">
                        <label for="nonce-input">Your Chosen Nonce:</label>
                        <input
                            type="number"
                            id="nonce-input"
                            placeholder="Enter a number (0 to 4,294,967,295)"
                            min="0"
                            max="4294967295"
                            autocomplete="off"
                        >
                        <div class="nonce-hint">Pick any 32-bit number. Fortune favors the bold!</div>
                    </div>

                    <!-- Pickaxe Mining Area -->
                    <div class="mining-area-container">
                        <div class="mining-area" id="mining-area">
                            <div class="rock-face" id="rock-face">
                                <div class="ore-vein"></div>
                                <div class="ore-vein"></div>
                                <div class="ore-vein"></div>
                            </div>
                            <div class="result-layer" id="result-layer">
                                <div class="hash-display" id="hash-display">
                                    Enter a nonce and swing!
                                </div>
                            </div>
                            <div class="pickaxe-container" id="pickaxe-container">
                                <button class="pickaxe-btn" id="pickaxe-btn" disabled>
                                    <span class="pickaxe-icon">&#9935;</span>
                                    <span class="pickaxe-text">SWING!</span>
                                </button>
                            </div>
                            <div class="sparks" id="sparks"></div>
                        </div>
                        <p class="mining-hint">Enter a nonce above, then swing your pickaxe!</p>
                    </div>

                    <!-- Prize Display -->
                    <div class="prize-section">
                        <div class="prize-label">BLOCK REWARD</div>
                        <div class="prize-amount" id="prize-amount">3.125 BTC</div>
                        <div class="prize-sats" id="prize-sats">(312,500,000 sats)</div>
                    </div>

                    <!-- Auto-Mining Toggle -->
                    <div class="auto-mine-section">
                        <div class="auto-mine-toggle">
                            <label class="toggle-label">
                                <input type="checkbox" id="auto-mine-toggle">
                                <span class="toggle-slider"></span>
                                <span class="toggle-text">Auto-Mine Mode</span>
                            </label>
                            <span class="toggle-hint">(Betrays goblin principles, but faster)</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Right Column: Mining Status -->
            <section class="status-section">
                <div class="status-panel">
                    <h2>&#9881; Mining Status &#9881;</h2>

                    <div class="stats-grid">
                        <div class="stat-item" data-tooltip="Number of pickaxe swings (hashes) performed per second when auto-mining.">
                            <span class="stat-label">Swing Rate <span class="info-icon">?</span></span>
                            <span class="stat-value" id="hash-rate">0 H/s</span>
                        </div>
                        <div class="stat-item" data-tooltip="Total number of pickaxe swings since you started. Each swing tries one nonce.">
                            <span class="stat-label">Total Swings <span class="info-icon">?</span></span>
                            <span class="stat-value" id="total-hashes">0</span>
                        </div>
                                                <div class="stat-item" data-tooltip="The last nonce you tried (or current nonce in auto-mine mode).">
                            <span class="stat-label">Last Nonce <span class="info-icon">?</span></span>
                            <span class="stat-value" id="current-nonce">-</span>
                        </div>
                        <div class="stat-item" data-tooltip="Time since mining started on this block template.">
                            <span class="stat-label">Elapsed Time <span class="info-icon">?</span></span>
                            <span class="stat-value" id="elapsed-time">0:00</span>
                        </div>
                        <div class="stat-item" data-tooltip="The smallest hash (as a 256-bit number) found so far. Lower values have more leading zeros and are closer to meeting the target.">
                            <span class="stat-label">Best Hash <span class="info-icon">?</span></span>
                            <span class="stat-value stat-hash" id="best-hash">-</span>
                        </div>
                    </div>

                    <div class="block-info">
                        <h3>Block Info</h3>
                        <div class="info-row-grid">
                            <div class="info-cell" data-tooltip="The block number you're trying to mine. This is one more than the current blockchain tip.">
                                <span class="info-label">Height <span class="info-icon">?</span></span>
                                <span class="info-value" id="info-height">-</span>
                            </div>
                            <div class="info-cell" data-tooltip="Current network difficulty. The target your hash must beat.">
                                <span class="info-label">Difficulty <span class="info-icon">?</span></span>
                                <span class="info-value" id="info-difficulty">-</span>
                            </div>
                        </div>
                        <div class="info-row" data-tooltip="Hash of the previous block in the chain. Your block will reference this.">
                            <span>Prev Hash: <span class="info-icon">?</span></span>
                            <span class="hash-short" id="info-prev-hash">-</span>
                        </div>
                    </div>

                    <!-- Mining Controls (for auto-mine) -->
                    <div class="controls" id="auto-controls" style="display: none;">
                        <button id="start-btn" class="btn btn-primary" disabled>
                            START AUTO-MINING
                        </button>
                        <button id="stop-btn" class="btn btn-secondary" disabled>
                            STOP
                        </button>
                    </div>
                </div>

                <!-- Technical Explanation Panel -->
                <div class="tech-panel">
                    <h3>&#9881; How Goblin Mining Works &#9881;</h3>
                    <div class="tech-content">
                        <div class="tech-section">
                            <h4>Block Construction</h4>
                            <p>Your block contains a single <strong>coinbase transaction</strong> that creates new bitcoins and sends them to your address. The block header (80 bytes) includes:</p>
                            <ul>
                                <li><strong>Version</strong> - Protocol version with BIP9 signaling bits</li>
                                <li><strong>Previous Block Hash</strong> - Links to the blockchain</li>
                                <li><strong>Merkle Root</strong> - Hash of all transactions (just coinbase here)</li>
                                <li><strong>Timestamp</strong> - Current Unix time</li>
                                <li><strong>Bits</strong> - Compact difficulty target</li>
                                <li><strong>Nonce</strong> - <em>YOUR chosen number!</em></li>
                            </ul>
                        </div>
                        <div class="tech-section">
                            <h4>The Sacred Swing</h4>
                            <p>When you swing your pickaxe, we compute <strong>SHA256(SHA256(header))</strong> with your chosen nonce. The resulting hash is interpreted as a 256-bit number and compared against the target. If hash &le; target, you've found a valid block!</p>
                            <p>At current mainnet difficulty, the target is so low that valid hashes typically have many leading zero bytes. Your odds of finding a block: <strong id="block-odds">calculating...</strong></p>
                        </div>
                        <div class="tech-section">
                            <h4>Why Solo Mining?</h4>
                            <p>Pools are for ASIC users who need to smooth out variance. A true goblin mines alone, swinging their pickaxe with honor. Besides, pools have water, and goblins can't swim.</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>
                Goblin Mining Co. - Keeping the old ways alive since the Genesis Block.
                <br>
                Your odds of finding a mainnet block: approximately <span id="footer-odds">1 in 10<sup>23</sup></span> per swing.
                <br>
                <span class="footer-motto">"We mine not because it is efficient, but because it is ours."</span>
            </p>
        </footer>
    </div>

    <!-- Winner Modal -->
    <div class="modal" id="winner-modal">
        <div class="modal-content winner-modal">
            <h2>&#9881; STRIKE! &#9881;</h2>
            <p>By the ancient gears, you found a valid block!</p>
            <div class="winner-hash" id="winner-hash"></div>
            <div class="winner-nonce">Winning Nonce: <span id="winner-nonce"></span></div>
            <button id="submit-block-btn" class="btn btn-primary">Submit Block to Network</button>
            <button id="close-modal-btn" class="btn btn-secondary">Close</button>
        </div>
    </div>

    <!-- New Block Toast -->
    <div class="toast" id="block-toast">
        <span id="toast-message"></span>
    </div>

    <!-- Scripts -->
    <script>
        // Explainer toggles (runs immediately, no module dependency)
        document.addEventListener('DOMContentLoaded', function() {
            // Block explainer toggle
            const expandBtn = document.getElementById('expand-btn');
            const explainerSection = document.querySelector('.explainer-section');
            if (expandBtn && explainerSection) {
                expandBtn.addEventListener('click', function() {
                    explainerSection.classList.toggle('expanded');
                });
            }

            // Lore toggle
            const loreExpandBtn = document.getElementById('lore-expand-btn');
            const loreSection = document.querySelector('.lore-section');
            if (loreExpandBtn && loreSection) {
                loreExpandBtn.addEventListener('click', function() {
                    loreSection.classList.toggle('expanded');
                });
            }
        });
    </script>
    <script type="module" src="js/app.js"></script>
</body>
</html>
